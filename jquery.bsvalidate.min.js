/*!
 * jQuery bsValidate Plugin
 * Form Validation for Twitter Bootstrap Forms (https://github.com/matthewjmink/bsValidate)
 * Copyright 2015 Matt Mink
 * Licensed under MIT (https://github.com/matthewjmink/bsValidate/blob/master/LICENSE)
 */
!function(a,b,c,d){"use strict";function e(b,c){s.alertTarget=a(b),this.element=b,this.settings=a.extend({},s,c),this._defaults=s,this._name=r,this.init()}function f(a,b){var c=!0;return a[b].required.dependency&&(a[b].required.dependency.isBlank&&(c=c&&g(a,a[b].required.dependency.isBlank)),a[b].required.dependency.isNotBlank&&(c=c&&h(a,a[b].required.dependency.isNotBlank))),c}function g(a,b){var c=0;"string"==typeof b&&(b=b.split(","));for(var d=0;d<b.length;d++)a[b[d]].el.isBlank()&&c++;return c===b.length}function h(a,b){var c=0;"string"==typeof b&&(b=b.split(","));for(var d=0;d<b.length;d++)a[b[d]].el.isBlank()||c++;return c===b.length}function i(a,b,c,d){return a?("undefined"!=typeof b&&k(c,b,d),1):("undefined"!=typeof b&&l(c,d),0)}function j(a,b,c,d){return a?("undefined"!=typeof b&&m(c,b,d),1):("undefined"!=typeof b&&n(c,d),0)}function k(b,c,d){if(b.find("."+d).length<1){var e=a('<span class="help-block '+d+'">'+c+"</span>");b.append(e)}}function l(a,b){var c=a.find("."+b);c.remove()}function m(b,c,d){if(b.find("."+d).length<1){var e=a('<div class="alert alert-danger '+d+'">'+c+"</div>");b.prepend(e)}}function n(a,b){var c=a.find("."+b);c.remove()}function o(b){var c,d=b.data,e=d.bsv,g=a(e.element),h=a(b.target),j=d.fields,k=d.key,l=h.parents(".form-group"),m=0,n=h.val();if("undefined"!=typeof j[k].hasDependency){var o=j[k].hasDependency.split(",");if(o.length>1||j[o[0]].el[0]!==b.relatedTarget)for(var r=0;r<o.length;r++){var s=j[o[r]].el.isBlank(e),t=j[o[r]].el.parents(".form-group");c="help-required",s=s&&f(j,o[r]);var u=i(s,j[o[r]].required.helpText,t,c);u?t.addClass("has-error"):t.removeClass("has-error")}}if("undefined"!=typeof j[k].required){var v=j[k].el.isBlank(e);c="help-required",v=v&&f(j,k),m+=i(v,j[k].required.helpText,l,c)}if("undefined"!=typeof j[k].email&&(c="help-email",m+=i(!q(n)&&""!==n,j[k].email.helpText,l,c)),"undefined"!=typeof j[k].characters&&(c="help-characters",m+=i(n.length>j[k].characters.limit,j[k].characters.helpText,l,c)),"undefined"!=typeof j[k].regex&&(c="help-regex",m+=i(!p(j[k].regex.pattern,n)&&!h.isBlank(e),j[k].regex.helpText,l,c)),"undefined"!=typeof j[k].match){c="help-match";var w=g.find('[name="'+j[k].match.field+'"]').val();m+=i(w!==n&&!h.isBlank(e),j[k].match.helpText,l,c)}m>0?l.addClass("has-error"):l.removeClass("has-error")}function p(a,b){return b.match(a)}function q(a){var b=/[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i;return b.test(a)}var r="bsValidate",s={requiredSelector:"input.required,textarea.required,select.required,[required]",fields:{},mergeAlerts:!1,alertMessage:null,blankSelectValue:"",novalidate:!0,before:function(){},success:function(){},fail:function(a){a.preventDefault()}};a.extend(e.prototype,{init:function(){var b=this,c=a(b.element),d=c.find(b.settings.requiredSelector),e=b.settings.fields,g=c.attr("novalidate");"undefined"==typeof g&&b.settings.novalidate&&c.attr("novalidate",""),d.each(function(){var b=a(this).attr("name");if("undefined"==typeof e[b]||"undefined"==typeof e[b].required){var c=a(this).parents(".form-group"),d=c.find(".label,label").text();e[b]="undefined"==typeof e[b]?{}:e[b],e[b].el=a(this),e[b].required={alert:d+" is required."}}}),a.each(e,function(d,f){("object"!=typeof e[d].el||"undefined"==typeof e[d].el.jquery)&&(e[d].el=c.find('[name="'+d+'"]')),e[d].required&&e[d].required.dependency&&a.each(e[d].required.dependency,function(a,f){for(var g=f.split(","),h=0;h<g.length;h++)e[g[h]]||(e[g[h]]={el:c.find('[name="'+g[h]+'"]')},e[g[h]].el.on("blur",{bsv:b,fields:e,key:g[h],value:e[g[h]]},o)),e[g[h]].hasDependency?e[g[h]].hasDependency+=","+d:e[g[h]].hasDependency=d}),e[d].el.length>0?e[d].el.on("blur",{bsv:b,fields:e,key:d,value:f},o):delete e[d]}),c.submit(function(d){d.preventDefault(),b.settings.before();var g=!0,h=b.settings.mergeAlerts?b.settings.alertMessage:"",i=!1;null===h&&(h="<ul>",i=!0),a.each(e,function(a,d){var k,l=e[a].el.parents(".form-group"),m=0,n=e[a].el.val(),o=a.replace(/[^a-zA-Z\d-]/g,"-");if("undefined"!=typeof e[a].required){var r=e[a].el.isBlank(b);k="alert-"+o+"-required",r=r&&f(e,a),m+=b.settings.mergeAlerts?0|r:j(r,e[a].required.alert,b.settings.alertTarget,k),h+=i?"<li>"+e[a].required.alert+"</li>":""}if("undefined"!=typeof e[a].email&&(k="alert-"+o+"-email",m+=b.settings.mergeAlerts?!q(n)&&0|!e[a].el.isBlank(b):j(!q(n)&&!e[a].el.isBlank(b),e[a].email.alert,b.settings.alertTarget,k),h+=i?"<li>"+e[a].email.alert+"</li>":""),"undefined"!=typeof e[a].characters&&(k="alert-"+o+"-characters",m+=b.settings.mergeAlerts?n.length>e[a].characters.limit|0:j(n.length>e[a].characters.limit,e[a].characters.alert,b.settings.alertTarget,k),h+=i?"<li>"+e[a].characters.alert+"</li>":""),"undefined"!=typeof e[a].regex&&(k="alert-"+o+"-regex",m+=b.settings.mergeAlerts?!p(e[a].regex.pattern,n)&&0|!e[a].el.isBlank(b):j(!p(e[a].regex.pattern,n)&&!e[a].el.isBlank(b),e[a].regex.alert,b.settings.alertTarget,k),h+=i?"<li>"+e[a].regex.alert+"</li>":""),"undefined"!=typeof e[a].match){k="alert-"+o+"-match";var s=c.find('[name="'+e[a].match.field+'"]').val();m+=b.settings.mergeAlerts?s!==n&&0|!e[a].el.isBlank(b):j(s!==n&&!e[a].el.isBlank(b),e[a].match.alert,b.settings.alertTarget,k),h+=i?"<li>"+e[a].regex.alert+"</li>":""}m>0?(l.addClass("has-error"),g=!1):l.removeClass("has-error")}),j(!g&&b.settings.mergeAlerts,h,b.settings.alertTarget,"bsv-alert"),g?b.settings.success(d):b.settings.fail(d)})},destroy:function(b){var c=this,d=c.settings.fields;c.settings.fields={},a.each(d,function(a,b){"object"==typeof b.el&&"undefined"!=typeof b.el.jquery&&b.el.off("change blur",o)}),a(c.element).off("submit").removeData(),b&&b()}}),a.fn[r]=function(b){return this.each(function(){var c=a.data(this,"plugin_"+r);c?"destroy"===b&&c.destroy():a.data(this,"plugin_"+r,new e(this,b))})},a.fn.isBlank=function(a){var b=this.val();return this.is(":checkbox")?!this.is(":checked"):""===b||null===b||b.length<1||"select"===this[0].nodeName.toLowerCase()&&b==a.settings.blankSelectValue},a.fn.destroy=function(){return this.each(function(){var b=a.data(this,"plugin_"+r);b&&b.destroy()})}}(jQuery,window,document);